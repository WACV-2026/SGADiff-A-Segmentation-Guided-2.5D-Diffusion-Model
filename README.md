# SGADiff: A Segmentation-Guided 2.5D Diffusion Model for CT Volume Generation from Synthesized Aorta Meshes

<div align='center'>
<img src='video.gif'>
</div>

## Introduction
> SGADiff (Segmentation-Guided 2.5D Diffusion) is a novel framework for synthesizing realistic 3D aortic CT volumes from synthetic aorta meshes.
The pipeline operates in two stages:

1. Anatomical Priors – Diverse aorta meshes are generated by HUG-VAS and voxelized into segmentation masks, providing explicit structural guidance.

2. Segmentation-Guided Diffusion – A 2.5D diffusion model is trained to generate CT slices conditioned on these masks. During inference, an imputation and sliding-window strategy ensures smooth axial continuity across slices.

SGADiff enables controllable synthesis of healthy and pathological cases (e.g., aneurysms, coarctations), addressing the scarcity of pathological imaging data. The generated volumes can be organized into datasets for downstream research, model training, and clinical applications.

---
## Architecture overview of SurfPatch
> SurfPatch is for analyzing surfaces through a three-stage process: (1) classifying vertices based on heat kernel signature (HKS) features and partitioning the surface into fine-grained patches using agglomerative hierarchical clustering (AHC) with connectivity constraints, (2) matching similar patches within or across surfaces by aggregating vertex-level features into patch-level features, and (3) clustering surfaces by further aggregating patch-level features into surface-level features, enabling efficient querying and exploration of patches and surfaces.
<div align='center'>
<img src='framework.png'>
</div>

## Installation
The code is developed by Python. After cloning the repository, follow the steps below for installation:
1. Create and activate the conda environment
```python
conda create --name surfpatch python=3.10
conda activate surfpatch
```
2. Install dependencies
```python
pip install -r requirements.txt
```
3. Run the interface
```python
python main.py
```

## Dataset
SurfPatch could handle stream surfaces generated from steady and unsteady flows and isosurfaces extracted from scalar fields. The dataset folder for surfaces should be organized as follows:
```
./dataset/
|
├── data/
├── gallery/
├── hks_feature/
├── patch/
│   └── level1/
└── project2d/
    └── level1/
```
We provide a subset of the [Two Swirls dataset](https://drive.google.com/drive/folders/1-PPu12Ls-kHmZtfqaNW3rfJ199-R4bpg?usp=drive_link) as an example for testing our method.

## Contact
Should you have any questions, please send emails to dan3@nd.edu.











